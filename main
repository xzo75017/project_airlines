import API_flightapi as API
from DB_Mongo import DB_Mongo
from gestion_fichiers import Fichier
from Insertion_Mongo import insertion_mdb
import json




def main():           
    
    depart = input("D'ou partez-vous?")
    arrive = input("Ou allez-vous?")
    operation = input("1 pour un aller simple, 2 pour un aller retour : ")
    date = input("Quand partez-vous?")
    adulte = input("Combien d'adultes?")
    enfant = input("Combien d'enfant?")
    bebe = input("Combien de bebe?")
    classe = input("En quelle classe voulez-vous Ãªtre?")
    devise = input("Avec quelle devise allez-vous payer?")
    
    filter = depart + '/' + arrive + '/' + date + '/' + adulte + '/' + enfant + '/' + bebe + '/' + devise
    filter = 'LHR/LAX/2022-11-11/2/0/1/Economy/USD'
    operation = 'onewaytrip'
    print(filter)
    
    reponse = API.requete_api_flightapi(operation, filter)
    
    io = open(Fichier(operation, reponse).link, "r")
    data = json.load(io)
    
    db = DB_Mongo()  
    insertion_mdb(data, db)
    
    
if __name__=="__main__":
    main()